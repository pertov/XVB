{
	Height:"\\\\\\",
	Width:"640",
	Type:"Box",
	BackGround:"\\\\",
	Border:"\\",
	Visible:"1",
	Name:"TLB",
	TitleBar:"1",
	VBS:"2",
	SysMenu:"1",
	StartPos1:"2",
	Popup:"3",
	Script:"sub Me_Create\r\n#include mod_TLBIcon\r\nOn Error Resume Next\r\nDim f,tlb:set tlb=Createobject(\"xvbTypeLib.xTypeLib\")\r\nf=NzS(cpsource(\"typelib\"),SplitIndex(CMDLine,\";\"))\r\ncpsource(\"view\")=aVal(cpsource(\"view\"))\r\nif tlb is nothing then cpsource(\"Visible\")=0:CloseForm() else Installed:AsyncExec \"Load \"&Quot(f)\r\nend sub\r\n\r\nsub Load(f)\r\nif len(f)=0 then exit sub\r\nDim v:v=IFF(aVal(cpsource(\"view\")),1,0)\r\nif len(f)=1 then\r\n\tv=IFF(aval(f),1,0)\r\n\tif aVal(cpsource(\"view\"))=v then exit sub\r\n\tcpsource(\"view\")=v\r\n\tmenu.CapItem(\"VB decl\").Checked=(v=1)\r\n\tmenu.CapItem(\"C decl\").Checked=(v=0)\r\n\tf=Nz(cpsource(\"typelib\"))\r\nelse\r\n\tcpsource(\"typelib\")=f\r\nend if\r\n\r\nCaption=\"xvbTLBViewer::\"&f\r\nnv.Vars.Clear\r\nnv.OpenRows 0,\"s$\",0,null\r\n\r\nDim tlb:set tlb=Createobject(\"xvbTypeLib.xTypeLib\")\r\ntlb.VBMode=v\r\ndim b\r\nif left(f,1)=\"{\" then b=tlb.LoadRegTlb(f) else b=tlb.Load(f)\r\nnv.Properties(\"ColumnWidths\")=80\r\nnv.Properties(\"ColumnCaps\")=\"NO TYPELIB IN \" & f\r\nif b=0 then nv.SetBandCount 1:exit sub\r\n\r\n\r\nif v then'VBDecl\r\n\tDim s:s=tlb.GetEscapedRows\r\n\ttlb.Free\r\n\tif len(s) then src=\"ID$\tPID$\tNAME$\tICON&\tTXT$\tVAL$\tds_$\"&vbCrLf&s\r\n\tnv.Properties(\"ColumnCaps\")=\"||Name||VB Declaration||\"\r\n\tnv.Properties(\"ColumnWidths\")=\"0,0,250,0,150,-80\"\r\n\tnv.Properties(\"AutoWidth\")=5\r\n\tnv.OpenRows 0,src,8,\"\",,\"NAME\"\r\n\tnv.SetBandCount 6\r\nelse\r\n\tVars.Value=tlb.CPSource\r\n\ttlb.Free\r\n\tnv.vars.value=Vars.Source\r\n\tnv.Properties(\"ColumnCaps\")=\"||Name||IDL Type|CLSID/DISPID|Value\"\r\n\tnv.Properties(\"ColumnWidths\")=\"0,0,100,0,100,250,-80\"\r\n\tnv.Properties(\"AutoWidth\")=3\r\n\tnv.OpenRows 44,nv.Vars,8,\"\",,\";;;ic_,baz_,uid_,hc_,ds_\"\r\n\tnv.SetBandCount 7\r\nend if\r\nend sub\r\n\r\nsub Installed:dim a:for each a in Split(\"dll,ocx,exe,tlb\",\",\"):menu.CapItem(\"View \"&a&\"file\").Checked=RegV(a&\"file\",0):next:RedrawMenu:end sub\r\n\r\nfunction Install(a):menu.CapItem(\"View \"&a).Checked=RegV(a,IFF(aVal(RegV(a,0)),-1,1)):RedrawMenu:end function\r\n\r\nFunction RegV(a,v)\r\nDim c,c0,s,sc:s=\"xvbTLBViewer\":sc=\"SOFTWARE\\Classes\\\"&a\r\nc=Nz(RegValue(2,sc&\"\\shell\\\"&s&\"\\command\",\"\"))\r\nc0=App.Path&\"\\\"&app.ExeName&\".exe *Vars\\TLB;%1\"\r\nselect case v\r\ncase 0:RegV=IFF(c0=c,1,0)\r\ncase 1,-1\r\n\tRegValue(2,sc&\"\\shell\\\"&s&\"\\command\",\"\")=IFF(v=1,c0,Null)\r\n\tRegValue(2,sc&\"\\shell\\\"&s&\"\",\"\")=IFF(v=1,s,Null)\r\n\tRegV=RegV(a,0)\r\nend select\r\nEnd function\r\n\r\nsub OpenRefTLB\r\nif cpsource(\"view\") then exit sub\r\nDim s:s=NzS(nv,,,\"\\\")\r\nif aval(nv.Vars(s&\"tp_\"))<>11 then exit sub\r\ns=nv.Vars(s&\"uid_\")&\"/\"&nv.Vars(s&\"ver_\")&\"/0\" \r\nif len(s)>=38 then NewForm cpsource.url,,Array(\"typelib\",s)\r\nend sub\r\n",
	nv:{Left:"5",Top:"0",Height:"15",Width:"100",Visible:"1",Type:"Grid",Border:"2",Name:"nv",Layout:"R,Parent,W,,,-5\r\nB,Parent,H,,,-5",SelColor:"&HBFFFFF",SelType:"6",TextAlign:0,TextColumn:2,RowHeight:16,ColumnCount:"5",HeaderHeight:-1,ColumnWidths:"0,0,100,0,150,220",AutoWidth:"3",TreeIcons:"pTLBIcon(aVal(nv.List(3,-3)))",TreeLines:"1",ContextMenu:"nv.TipText=nv.vars.View(nv)",StatusBar:"DW0¦DH30¦TA&H2010¦TC2¦{nv.ListS(\"ds_\")}",TreeExpanded:"2",DblClick:"OpenRefTLB",ColumnCaps:"||Name"},
	xControls:"nv",
	Icon:"51",
	Menu:"15<Open;P;2;I;Load GetFileName(hWnd,\"\",\"typelib,*.dll\\;*.ocx\\;*.exe\\;*.tlb\")><View<VB decl;I;Load 1><C decl\\c;I;Load 0>><Help<View dllfile;I;Install(\"dllfile\")><View ocxfile;I;Install(\"ocxfile\")><View exefile;I;Install(\"exefile\")><View tlbfile;I;Install(\"tlbfile\")><\\s><About;I;msbox help,vbInformation,App.ProductName>>",
	StartApp:"1",
	Help:"typelib viewer with xTypeLib.dll",
	Buttons:"3",
	mod_TLBIcon:"Function pTLBIcon(byval id)\r\nDim ic,icp,hx:icp=\"\":hx=\"A335A63AB63B31CA9F013310B6B6B5B5B6B6B5B5183636363636363617B5183636363636363617B52FB7191937\"\r\nif id>999 then icp=\"CA\":id=id-1000\r\nif id<0 or id>44 then id=0\r\nic=mid(hx,1+id*2,2)\r\npTLBIcon=CLng(\"&H\"&icp&ic&ic&ic)\r\nend Function\r\n",
	NoEvent:"1"
}